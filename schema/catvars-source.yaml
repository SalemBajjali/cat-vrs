$schema: http://json-schema.org/draft/2020-12/schema
title: GA4GH-Categorical-Variation-Definitions
type: object
strict: true

imports:
  gks.core: core-source.yaml
  vrs: vrs-source.yaml

namespaces:
  vrs: vrs.json#/definitions/

$defs:
  # VRSATILE Categorical Variation are presented top-down. Everything rolls up to
  # CategoricalVariation, which is a polymorphic abstraction of many kinds of
  # categorical variation.

  # =============================================================================
  # Top-level Categorical Variation concepts
  # =============================================================================

  CategoricalVariation:
    inherits: gks.core:MappableEntity
    description: >-
      A representation of a categorically-defined 
      `functional domain <https://en.wikipedia.org/wiki/Domain_of_a_function>`_ 
      for variation, in which individual variation instances may be members.
    properties:
      constraints:
        type: array
        description: >-
          A collection of constraints that define a categorical variation.
        items:
          $ref: "#/$defs/Constraint"
      members:
        type: array
        description: >-
          A non-exhaustive list of VRS variation contexts that satisfy the constraints of
          this categorical variant.
        items:
          anyOf:
            - $refCurie: vrs:Variation
            - $ref: "#/$defs/"

  Constraint:
    inherits: Entity
    type: object
    description: >-
      A property that constrains the domain of a categorical variant.
    heritableRequired:
      - type

  CanonicalAllele:
    inherits: Constraint
    type: object
    properties:
      type:
        type: string
        const: "CanonicalAllele"
      definingContext:
        type:
          $refCurie: vrs:Variation
        description: >-
          The `VRS Variation <https://vrs.ga4gh.org/en/2.0/terms_and_model.html#variation>`_
          object to which congruency must be determined.

  CanonicalLocation:
    inherits: Constraint
    type: object
    properties:
      type:
        type: string
        const: "CanonicalLocation"
      definingContext:
        type:
          $refCurie: vrs:Location
        description: >-
          The `VRS Location <https://vrs.ga4gh.org/en/2.0/terms_and_model.html#location>`_
          object describing the location range for the categorical variant.
      matchCharacteristic:
        type: string
        enum:
          - exact
          - partial
          - complete

  


  # GeneContext:
  #   inherits: Constraint
  #   type: object
  #   properties:
  #     type:
  #       type: string
  #       const: "GeneContext"
  #     definingGene:
  #       description: >-
  #         The gene context for which variants must be evaluated.


  # ComplexVariation:
  #   type: object
  #   inherits: CategoricalVariation
  #   description: >-
  #     A categorical variation domain jointly characterized by two or more other categorical 
  #     variation domains.
  #   properties:
  #     type:
  #       type: string
  #       description: MUST be "ComplexVariation".
  #       const: ComplexVariation
  #     operands:
  #       type: array
  #       ordered: false
  #       items:
  #         $ref: "#/$defs/CategoricalVariation"
  #       minItems: 2
  #       description: >-
  #         The :ref:`CategoricalVariation` objects that are being evaluated collectively.
  #     operator:
  #       type: string
  #       enum: ["AND", "OR"]
  #       description: >-
  #         The logical operation applied to evaluating the object *operands*. MUST
  #         be "AND" or "OR".
  #   required: ["operands", "operator"]

  CategoricalCopyNumber:
    type: object
    inherits: CategoricalVariation
    description: >-
      A categorical variation domain characterized by a canonical Sequence Location
      with a 


  CanonicalAllele:
    type: object
    inherits: CategoricalVariation
    description: >-
      A categorical variation domain characterized by a canonical Variation context 
      to which members lift-over, project, translate, or otherwise directly align.
    properties:
      type:
        type: string
        const: CanonicalAllele
        default: CanonicalAllele
        description: MUST be "CanonicalAllele".
      canonical_context:
        $refCurie: vrs:Variation
        description: >-
          The `VRS Variation <https://vrs.ga4gh.org/en/1.2.1/terms_and_model.html#variation>`_
          object to which congruency must be determined.
    required: ["canonical_context"]
